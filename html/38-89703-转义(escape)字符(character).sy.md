---
show: step
version: 1.0
enable_checker: true
---

# 转义字符

## 回忆上次内容

- 这次研究了通过 8 进制数值转义
  - `\nnn`
  - 把(`nnn`)<sub>`8进制`</sub>对应的`ascii`字符输出
- 转义序列
  - `\n`、`\t`是转义序列
  - `\xhh`也是转义序列
  - `\nnn`还是转义序列
- `\` 反斜杠 backslash 是转义字符
- 如果就想要输出反斜杠`\` 应该怎么办？🤔

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220918-1663509882746/wm)

- 搜一下呗!

### 搜索结果

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210224-1614168433167)

- 答案就是用两个反斜杠
- `\\`
  - 第一个是转义字符`\`
  - 第二个是转义序列的对应字符
  - 也就是说转义序列`\\` 对应着ascii码表中的`\`
- 这样就可以输出`\`了

### 输出一个反斜杠

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210224-1614168571449)

- 只有一个转义字符
	- \被用来转了双引号
	- 导致最开始的双引号没有封闭
	- EOL end of line 
	- 扫描到结尾也不知道字符串结束
	- 语法错误了
- 两个反斜杠 
	- 在输出的时候就成了一个反斜杠
	- 如果我要的是多个`\`
	- 应该如何呢？

### 多个`\`

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210225-1614252170776)

- 不要收到上图的干扰
  - 这个应该是什么规律？
  - 自己想一下
  - 试一下
- 那如果我想输出`\n`呢

### 转义字符的输出

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220408-1649382401365)

- 但如果我要给转义序列加上引号呢？

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220408-1649382448925)

### 引号的输出

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220408-1649382503560)

- 引号也需要转义
- 引号其实有三种
	- 单引号
	- 双引号
	- 反引号

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220408-1649382638467)

- 反引号不用转义
- 如果我想要单双引号也不用转义
- 有可能么？

### 岔开使用

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220408-1649382749549)

- 双引号里面的单引号不用转义
- 单引号里面的双引号不用转义
- 转来转去有点麻烦啊
- 能否直接原样输出呢？

### r 原样输出

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220408-1649405677589)

- r的含义是 
	- raw
	- 原始原样

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220408-1649405724508)

- 如果是raw就原样输出
- 如果没有r呢？

### 转义
- 没有r的话
	- 该转义还是要转义的

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220408-1649405790611)

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220408-1649405799566)

- 话说什么是转义来着呢？

### 转义 Escape

- 转义转义
	- 转化含义

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210224-1614157679393)

- 所以`\`反斜杠这个字符
	- 也叫做转义字符`Escape character`
	- `\b` 这两个字符的序列算是一个转义序列 `Escape sequence`
	- `\` 这个转义字符会让 `\b`转义序列 转义为 `Backspace`
	- `Backspace`退格是这个序列转化含义之后的含义
	- 这个转化后的含义也对应一个ascii字符
	- 就是 `\b`
	- 键盘上的<kbd>退格</kbd>对应的数值就是`8`

- 除了可以转义之外
	- 反斜杠还有神奇的作用


### 神奇的-反斜杠`\`

- python3 在多行输出的时候
	- 也有特别的应用
- `\`下一行需要连起来一起执行
	- 尝试下面这种东西
	- 在这里反斜杠实现的是续行的效果
	- 此处反斜杠其实就是 `"续行符"`

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220312-1647051056319)

```python
print("\
**************\n\
*            *\n\
*   oeasy    *\n\
*            *\n\
**************")
```

- 回车好像是`\n`
- 如果用\把上下的行都连起来
- 就要手动在结尾加上`\n`
- 我们能把cowsay的输出放到python程序里面么？

### 笨方法

```python3
print("\n\
 _______\n\
< oeasy >\n\
 -------\n\
    \\   ^__^\n\
     \\  (oo)\\_______\n\
        (__)\\       )\\/\\\n\
            ||----w |\n\
            ||     ||")
```

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210306-1615035013687)

- 怎么得到这个cow呢？

### 快速粘贴

- 先选中并复制牛和话

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220127-1643291861978)

```bash
vi test.py
```

- 在vim中
	- `:set nopaste`
		- 设置粘贴模式
- 正常状态下
	- 依次按下<kbd>"</kbd><kbd>*</kbd><kbd>p</kbd>
	- 从系统寄存器中粘贴刚刚复制出来的牛和话

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210813-1628842374296)


- 不过一行行改太麻烦了
- 能否原样输出呢？

### 三引号原样输出

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210307-1615080706509)

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210924-1632460604045)

- 能否输出一些好玩的
- 我们去看看这个三引号的帮助手册在哪？

### 查看参考

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220408-1649405241820)

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220408-1649405251817)

### 试炼

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220408-1649405416978)

- 动物输出
	- 原样输出 cowsay 之类的东西
	- 都给他放到三引号里面
	- 我可以试试吗？

### 走起来

```bash
sudo apt install cowsay
echo "oeasy" | cowsay -f turtle > t.py
vi t.py
```

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220313-1647134285172)

- 最后我们用vim打开t.py


![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220313-1647134422388)

- 前后加上三引号和 print 函数

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220313-1647134767034)

### 处理

- 如果直接运行的话
- 海龟会坍塌

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220313-1647134795614)

- 问题就在于 结尾处的反斜杠
	- 本来这反斜杠是龟壳的一部分
	- 由于在行尾
	- 被理解为了 `"续行符"` 
- 需要明确地写出反斜杠
	- `1` 个 `反斜杠(\)` 是代表着要 `转义`
	- `2` 个 `反斜杠(\\)` 才代表着 `反斜杠这个字符`
- 要把一个反斜杠替换为两个反斜杠
	- 怎么替换呢？

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210923-1632398476205)

### 批量替换

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220306-1646568598093)

- 我们一个个字符拆开了来分析
- `:%s/\\/\\\\/g`
	- `:` 表示进入命令行模式执行命令
	- `%` 表示从第一行到最后一行全范围执行命令
	- `s` 表示 `substitute` 查找替换
	- 查找内容和替换内容用`/`隔开
		- 查找内容是`\\`
			- 反斜杠本身是转义字符
			- 表示反斜杠这个字符需要两个反斜杠
			- `\\` 代表一个反斜杠
		- 替换内容是`\\\\`
			- `\\` 代表一个反斜杠
			- `\\\\` 代表两个反斜杠
	- `g`
		- `g`lobal 行中所有都`查找`

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220408-1649383298744)

### 换后效果

- 替换之后什么效果


![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220306-1646568667965)


### 最终效果

```python
print("""
 _______
< oeasy >
 -------
    \\                                  ___-------___
     \\                             _-~~             ~~-_
      \\                         _-~                    /~-_
             /^\\__/^\\         /~  \\                   /    \\
           /|  O|| O|        /      \\_______________/        \\
          | |___||__|      /       /                \\          \\
          |          \\    /      /                    \\          \\
          |   (_______) /______/                        \\_________ \\
          |         / /         \\                      /            \\
           \\         \\^\\\\         \\                  /               \\     /
             \\         ||           \\______________/      _-_       //\\__//
               \\       ||------_-~~-_ ------------- \\ --/~   ~\\    || __/
                 ~-----||====/~     |==================|       |/~~~~~
                  (_(__/  ./     /                    \\_\\      \\.
                         (_(___/                         \\_____)_)
""")
```

- 最终输出如下图所示

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210307-1615081544395)

###  重温
- 本次转义练习

- 我们把这些转义应用起来

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210224-1614172440096)

- 如果没有转义的话
- 很可能扫描的时候就会报错
- 不知字符串何时结束

## 总结

- 上次讲了`\n`、`\r` 之外的转义序列
  - `\a`是 ␇ (bell),
  - `\b` 退回一格
  - `\t` 水平制表符
  - `\v`、`\f` LineFeed
- 通过 16 进制数值转义
  - `\xhh`
  - 把(hh)<sub>16 进制</sub>对应的 ascii 字符输出
- 通过 8 进制数值转义
  - `\nnn`
  - 把(nnn)<sub>8 进制</sub>对应的 ascii 字符输出
- 这次加了 3 个
  - `\\ `输出 `\`
  - `\" `输出 `"`
  - `\' `输出 `'`
- 还有哪个转义字符我们一直没研究？🤔

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20210224-1614173286539)

- 这个`\e`是干什么的？
- 我们下次再说！👋
