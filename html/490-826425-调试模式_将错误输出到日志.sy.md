---
show: step
version: 1.0
enable_checker: true
---

# flask 最小应用

## 回忆上次

- 上次开启了最小应用
	- 并用python3直接运行

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230421-1682045241244)

- 现在服务器将各种信息直接输出到屏幕
	- 输出之后就没了
	- 可以将后台信息输出到日志吗？？🤔

### 直接运行

- 修改 hello.py

```
from flask import Flask

app = Flask(__name__)

@app.route("/")
def hello_world():
    return "<p>Hello, oeasy!</p>"

if __name__ == "__main__":
    app.run(debug=True)
```

- 运行成功

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230421-1682045350898)

- 调试模式有什么用吗？

### 调试模式效果

- 在服务器开启的情况下
	- 再开一个新的终端
		- 编辑app.py

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230421-1682045509028)

### 后台自动更新

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230421-1682045584710)

- 修改代码
	- 并且保存

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230421-1682045608740)

- 网页会更新

### 调试效果

- 动态网页服务器flask 会自动加载更新的文件
	- 页面 会更新到 最新的状态

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230123-1674463115111)

- 这就是
	- `调试`模式 的 作用
	- 可以实现`动态`加载 py代码的效果
- 可以将信息输出到日志吗？

### 输出报错日志

```
python3 app.py >> flask.log 2>&1
```

- 这样就将输出和报错
	- 写到flask.log
- :e
	- 编辑flask.log日志

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230421-1682046554807)

- 这样就可以
	- 输出到日志(log)
		- 然后查看报错信息了
- 什么是日志呢？

### 砍树

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220511-1652260918999)

- log本意是原木
	- 就是砍下来没有处理的树

### 砍
- 作为动词也有砍的意思

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220511-1652260931803)

- 可是这和日志有什么关系？🤔

### 大帆船

- 这些大树被做成了帆船

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220511-1652261673755)

- 在 地中海上
	- 水手 成天 头枕着波涛
	- 想家了
	- 就在船身上、甲板上甚至桅杆上
	- 轻轻滴划小道道
	- 早年间知识有限只能记录天数
- 这就是 航海日志	

### 航海日志

- 后来 大航海时代
	- 在苍茫的大海上
	- 狂风卷积着乌云
	- 要对航海日志这个事情量化
	- 不但要记录天数
	- 而且要记录
		- 日期
		- 位置
		- 天气
		- 甚至速度

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220511-1652261950334)

- 上面这个就是一个测速用的log
	- 当时水手们将一根连接在一根绳子上的原木(log)扔在水里
	- 绳子上定长打结
	- 水手们计算在给定时间内(一个沙漏)
		- 通过他们手中的节数
		- 给定时间用的是沙漏
		- 以确定船的速度
- 今天水手和飞行员仍然用节(knot)来表示速度

### 航海日志进化

- 沙漏和测速log虽然简陋
	- 但是总比没有强
	- 根据罗盘和速度大致估算出船在地图的位置
	- 所以会发生找不到藏宝岛屿山洞的事情

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220511-1652272413548)

- 随着时间的推进
	- 测量精度大幅提高

### 航海日志再进化

- 和根据太阳高度和罗盘
	- 配合六分仪判断当前的经纬度

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220511-1652272905648)

- Harrison4

### 时间的记录

- 航海钟表发明出了蚂蚱腿

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220511-1652273173433)

- 又如何记录航海日志呢？

### 航海日志

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220511-1652273224213)

- 日志有了自己的格式
	- 有了标准的表格

### 目前
- 最新科技
	- 基于原子钟的时间记录
	- 基于gps和北斗导航的定位系统
	- 各种仪表的参数记录
	- 都可以用电磁波同步到卫星或者地面站
	- 实时报告、实时监测

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220511-1652273516640)

- 同时也记录到黑匣子里
	- 从电子化到数字化
	- 更多更详细的东西都被记录到持久的媒体中
	- 作为军事、法律和商务的重要证据
	- 工业化普及之后
	- 一般的机器操作都有工作日志
	- 那么计算机时代呢
- 如何理解log

### 计算机时代

- 开了机器就自动写日志了
	- 如果有用户登录更要写清楚
	- 登录叫做login
	- 意思是logging in
	- 写日志

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220511-1652274179329)

- 退出的时候叫做 log out (log off). 
	- 1960s开始有大型分时操作系统
	- 这个专业术语也慢慢流行起来
	- 日志有几种呢？

### 日志种类
- 日志种类
	- 事件日志(Event logs)
	- 交易记录(Transaction log)
	- 消息日志(Message logs)
- 云时代能记录的都给记录了下来
- 电脑把自己干过的事
- 一桩桩
- 一件件
- 都像写日记一样写成日志

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220511-1652275018584)

- tomcat的日志属于什么类型？

### web服务器日志

- flask是动态网页服务器
- 肯定记录的都是动态网页那些事
	- 谁来了
		- 什么ip地址
	- 什么时候来的
	- 都发送了什么请求
	- 都给他记录下来

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220511-1652275459114)

- 这个日志在哪呢？

### flask日志

- 再开个窗口
	- 专门查看日志

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20220511-1652275683972)

- log都在logs里面
- 打开日志看看

### 总结

- 这次 设置了 
	- 直接运行
	- 调试模式
	- 输出重定向

![图片描述](https://doc.shiyanlou.com/courses/uid1190679-20230421-1682046745155)

- 目前只能访问首页
	- 可以设置 对于子url的 响应吗？
	- 比如http://localhost/oeasy
- 我们下次再说👋🏻